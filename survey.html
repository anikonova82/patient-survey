<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Aptos;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;}
.MsoChpDefault
	{font-family:"Aptos",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-CA style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal>&lt;!DOCTYPE html&gt;</p>

<p class=MsoNormal>&lt;html&gt;</p>

<p class=MsoNormal>&lt;head&gt;</p>

<p class=MsoNormal>    &lt;script
src=&quot;https://unpkg.com/survey-core@1.9.90/survey.core.min.js&quot;&gt;&lt;/script&gt;</p>

<p class=MsoNormal>    &lt;script
src=&quot;https://unpkg.com/survey-knockout-ui@1.9.90/survey-knockout-ui.min.js&quot;&gt;&lt;/script&gt;</p>

<p class=MsoNormal>    &lt;link
href=&quot;https://unpkg.com/survey-core@1.9.90/modern.min.css&quot;
rel=&quot;stylesheet&quot;/&gt;</p>

<p class=MsoNormal>&lt;/head&gt;</p>

<p class=MsoNormal>&lt;body&gt;</p>

<p class=MsoNormal>&lt;div id=&quot;surveyContainer&quot;&gt;&lt;/div&gt;</p>

<p class=MsoNormal>&lt;script&gt;</p>

<p class=MsoNormal>    Survey.StylesManager.applyTheme(&quot;modern&quot;);</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    const patients = [</p>

<p class=MsoNormal>        { value: &quot;patient1&quot;, text: &quot;John
Doe&quot; },</p>

<p class=MsoNormal>        { value: &quot;patient2&quot;, text: &quot;Jane
Smith&quot; },</p>

<p class=MsoNormal>        { value: &quot;patient3&quot;, text: &quot;Carlos
Vega&quot; }</p>

<p class=MsoNormal>    ];</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    let remainingPatients = [...patients];</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    function createPatientSelectionSurvey() {</p>

<p class=MsoNormal>        return {</p>

<p class=MsoNormal>            showQuestionNumbers: &quot;off&quot;,</p>

<p class=MsoNormal>            title: &quot;Select Patient&quot;,</p>

<p class=MsoNormal>            elements: [</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    type: &quot;dropdown&quot;,</p>

<p class=MsoNormal>                    name: &quot;selectedPatient&quot;,</p>

<p class=MsoNormal>                    title: &quot;Please select a patient to
answer questions about:&quot;,</p>

<p class=MsoNormal>                    choices: remainingPatients,</p>

<p class=MsoNormal>                    isRequired: true</p>

<p class=MsoNormal>                }</p>

<p class=MsoNormal>            ]</p>

<p class=MsoNormal>        };</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    function createQuestionSurvey(patientName) {</p>

<p class=MsoNormal>        return {</p>

<p class=MsoNormal>            showQuestionNumbers: &quot;onPage&quot;,</p>

<p class=MsoNormal>            title: `Questions for ${patientName}`,</p>

<p class=MsoNormal>            pages: [</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    elements: [{ type: &quot;text&quot;,
name: &quot;q1&quot;, title: &quot;What is the patient's main complaint?&quot;
}]</p>

<p class=MsoNormal>                },</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    elements: [{ type: &quot;text&quot;,
name: &quot;q2&quot;, title: &quot;How long has the patient had this
issue?&quot; }]</p>

<p class=MsoNormal>                },</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    elements: [{ type: &quot;text&quot;,
name: &quot;q3&quot;, title: &quot;Has the patient received any
treatment?&quot; }]</p>

<p class=MsoNormal>                },</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    elements: [{ type: &quot;text&quot;,
name: &quot;q4&quot;, title: &quot;Is the patient currently on
medication?&quot; }]</p>

<p class=MsoNormal>                },</p>

<p class=MsoNormal>                {</p>

<p class=MsoNormal>                    elements: [{ type: &quot;text&quot;,
name: &quot;q5&quot;, title: &quot;What is your recommended next step?&quot; }]</p>

<p class=MsoNormal>                }</p>

<p class=MsoNormal>            ]</p>

<p class=MsoNormal>        };</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    function startSurvey(surveyJson) {</p>

<p class=MsoNormal>        const survey = new Survey.Model(surveyJson);</p>

<p class=MsoNormal>        survey.onComplete.add(function (sender) {</p>

<p class=MsoNormal>            const selectedPatientId =
sender.data.selectedPatient;</p>

<p class=MsoNormal>            if (selectedPatientId) {</p>

<p class=MsoNormal>                // From selection screen</p>

<p class=MsoNormal>                const patientObj = patients.find(p =&gt;
p.value === selectedPatientId);</p>

<p class=MsoNormal>                runQuestionnaireForPatient(patientObj);</p>

<p class=MsoNormal>            } else {</p>

<p class=MsoNormal>                // From question screen</p>

<p class=MsoNormal>                runPatientSelection();</p>

<p class=MsoNormal>            }</p>

<p class=MsoNormal>        });</p>

<p class=MsoNormal>       
Survey.KnockoutSurvey.render(&quot;surveyContainer&quot;, { model: survey });</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    function runPatientSelection() {</p>

<p class=MsoNormal>        if (remainingPatients.length === 0) {</p>

<p class=MsoNormal>           
document.getElementById(&quot;surveyContainer&quot;).innerHTML =
&quot;&lt;h3&gt;All patients have been completed.&lt;/h3&gt;&quot;;</p>

<p class=MsoNormal>            return;</p>

<p class=MsoNormal>        }</p>

<p class=MsoNormal>        startSurvey(createPatientSelectionSurvey());</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    function runQuestionnaireForPatient(patient) {</p>

<p class=MsoNormal>        // Remove completed patient</p>

<p class=MsoNormal>        remainingPatients = remainingPatients.filter(p =&gt;
p.value !== patient.value);</p>

<p class=MsoNormal>        startSurvey(createQuestionSurvey(patient.text));</p>

<p class=MsoNormal>    }</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>    // Start the process</p>

<p class=MsoNormal>    runPatientSelection();</p>

<p class=MsoNormal>&lt;/script&gt;</p>

<p class=MsoNormal>&lt;/body&gt;</p>

<p class=MsoNormal>&lt;/html&gt;</p>

</div>

</body>

</html>
